{"version":3,"file":"HTMLSanitizer.js","sources":["../src/HTMLSanitizer.ts"],"sourcesContent":[null],"names":["regHrefJS","regValidSrc","regSystemAtt","defaultHTMLWhiteList","HTMLBRElement","HTMLBodyElement","HTMLDListElement","HTMLDataElement","HTMLDataListElement","HTMLDialogElement","HTMLDivElement","HTMLFieldSetElement","HTMLFormElement","HTMLHRElement","HTMLHeadingElement","HTMLLIElement","HTMLLegendElement","HTMLMapElement","HTMLMetaElement","HTMLMeterElement","HTMLModElement","HTMLOListElement","HTMLOutputElement","HTMLParagraphElement","HTMLPreElement","HTMLProgressElement","HTMLQuoteElement","HTMLSpanElement","HTMLTableCaptionElement","HTMLTableCellElement","HTMLTableColElement","HTMLTableElement","HTMLTableSectionElement","HTMLTableRowElement","HTMLTimeElement","HTMLTitleElement","HTMLUListElement","HTMLUnknownElement","HTMLTemplateElement","HTMLCanvasElement","HTMLElement","globalAllowedAtttributes","Set","sanitizeType","obj","t","allowedAttributes","element","s","type","types","set","attributes","HTMLSanitizer","constructor","Map","HTMLAnchorElement","HTMLAreaElement","el","HTMLButtonElement","HTMLInputElement","HTMLSelectElement","HTMLOptGroupElement","HTMLOptionElement","HTMLLabelElement","HTMLTextAreaElement","HTMLScriptElement","HTMLStyleElement","HTMLPictureElement","HTMLImageElement","HTMLAudioElement","HTMLTrackElement","HTMLVideoElement","HTMLSourceElement","santizeAttribute","attName","attValue","preprocess","allowed","get","toLowerCase","match","startsWith","setAttribute","slice","has","srcAttributes","isJs","hasAttribute","substring","length","allowedInputs","sanitizeHTML","staticHtml","DocumentFragment","remove","att","nodeValue","nodeName","includes","removeAttribute","children","observeAttribute","parent","cb","persistant","subs","selector","sanitize","elem","observeLoad","Promise","resolve","observer","MutationObserver","muts","mut","target","addedNodes","Element","document","addEventListener","sub","observe","childList","subtree","disconnect","delete","add","readyState","found","WeakSet","isFound","parentElement","matches","then","querySelectorAll","cancel"],"mappings":"AAEA,IAAMA,SAAS,GAAG,qBAAlB;AACA,IAAMC,WAAW,GAAG,2BAApB;AACA,IAAMC,YAAY,GAAG,qBAArB;AAA2C,IAAMC,oBAAoB,GAA0B,CAC7FC,aAD6F,EAE7FC,eAF6F,EAG7FC,gBAH6F,EAI7FC,eAJ6F,EAK7FC,mBAL6F,EAM7FC,iBAN6F,EAO7FC,cAP6F,EAQ7FC,mBAR6F,EAS7FC,eAT6F,EAU7FC,aAV6F,EAW7FC,kBAX6F,EAY7FC,aAZ6F,EAa7FC,iBAb6F,EAc7FC,cAd6F,EAe7FC,eAf6F,EAgB7FC,gBAhB6F,EAiB7FC,cAjB6F,EAkB7FC,gBAlB6F,EAmB7FC,iBAnB6F,EAoB7FC,oBApB6F,EAqB7FC,cArB6F,EAsB7FC,mBAtB6F,EAuB7FC,gBAvB6F,EAwB7FC,eAxB6F,EAyB7FC,uBAzB6F,EA0B7FC,oBA1B6F,EA2B7FC,mBA3B6F,EA4B7FC,gBA5B6F,EA6B7FC,uBA7B6F,EA8B7FC,mBA9B6F,EA+B7FC,eA/B6F,EAgC7FC,gBAhC6F,EAiC7FC,gBAjC6F,EAmC7FC,kBAnC6F,EAoC7FC,mBApC6F,EAqC7FC,iBArC6F,EAsC7FC,WAtC6F,CAApD;AAyC3C,IAAMC,wBAAwB,GAAG,IAAIC,GAAJ,CAAQ,CACvC,IADuC,EAEvC,OAFuC,EAGvC,OAHuC,EAIvC,KAJuC,EAKvC,MALuC,EAMvC,YANuC,EAOvC,iBAPuC,EAQvC,aARuC,EASvC,UATuC,EAUvC,OAVuC,EAWvC,KAXuC,EAYvC,MAZuC,EAavC,QAbuC,EAcvC,OAduC,CAAR,CAAjC;SAiBgBC,aAAaC,KAAoBC,GAA0BC,mBAA6BC;AACtG,MAAMC,CAAC,GAAG,IAAIN,GAAJ,CAAQI,iBAAR,CAAV;;AACA,OAAK,IAAIG,IAAT,IAAiBJ,CAAjB,EAAoB;AAClBD,IAAAA,GAAG,CAACM,KAAJ,CAAUC,GAAV,CAAcF,IAAd,EAAoB;AAACG,MAAAA,UAAU,EAAEJ,CAAb;AAAgBD,MAAAA;AAAhB,KAApB;AACD;AACF;MAGoBM;AAwBnBC,EAAAA;AAvBA,cAAA,GAAmG,IAAIC,GAAJ,EAAnG;AACA,sBAAA,GAAgB,IAAIb,GAAJ,CAAQ,CAAC,QAAD,EAAW,MAAX,EAAmB,YAAnB,EAAiC,YAAjC,EAA+C,UAA/C,EAA2D,QAA3D,EAAqE,KAArE,EAA4E,MAA5E,CAAR,CAAhB;AACA,sBAAA,GAAgB,IAAIA,GAAJ,CAAQ,CACtB,QADsB,EAEtB,UAFsB,EAGtB,OAHsB,EAItB,MAJsB,EAKtB,gBALsB,EAMtB,OANsB,EAOtB,MAPsB,EAQtB,OARsB,EAStB,QATsB,EAUtB,UAVsB,EAWtB,OAXsB,EAYtB,OAZsB,EAatB,OAbsB,EActB,KAdsB,EAetB,MAfsB,EAgBtB,MAhBsB,EAiBtB,KAjBsB,EAkBtB,MAlBsB,CAAR,CAAhB;AAsBEC,IAAAA,YAAY,CAAC,IAAD,EAAOxC,oBAAP,EAA6B,EAA7B,EAAiC;AAAQ,aAAO,IAAP;AAAa,KAAtD,CAAZ;AAEAwC,IAAAA,YAAY,CAAC,IAAD,EAAO,CAACa,iBAAD,EACLC,eADK,CAAP,EAEE,CAAC,MAAD,EACA,YADA,EAEA,KAFA,EAGA,OAHA,EAIA,QAJA,CAFF,EAMcC,EAAD;AAAmB,aAAO,IAAP;AAAc,KAN9C,CAAZ;AAOAf,IAAAA,YAAY,CAAC,IAAD,EAAO,CAACgB,iBAAD,CAAP,EAA4B,CAAC,MAAD,EAAS,OAAT,CAA5B,EAAgDD,EAAD;AACzD,UAAIA,EAAE,CAACT,IAAH,KAAY,OAAZ,IAAuBS,EAAE,CAACT,IAAH,KAAY,QAAvC,EAAiD;AAC/CS,QAAAA,EAAE,CAACT,IAAH,GAAU,QAAV;AACD;;AACD,aAAO,IAAP;AACD,KALW,CAAZ;AAMAN,IAAAA,YAAY,CAAC,IAAD,EAAO,CAACiB,gBAAD,EACLC,iBADK,EAELC,mBAFK,EAGLC,iBAHK,EAILC,gBAJK,EAKLC,mBALK,CAAP,EAME,CAAC,OAAD,EACA,MADA,EAEA,SAFA,EAGA,UAHA,EAIA,MAJA,EAKA,KALA,EAMA,KANA,EAOA,KAPA,EAQA,aARA,EASA,UATA,EAUA,MAVA,EAWA,UAXA,EAYA,MAZA,EAaA,cAbA,EAcA,MAdA,EAeA,MAfA,EAgBA,WAhBA,EAiBA,UAjBA,EAkBA,UAlBA,EAmBA,QAnBA,EAoBA,MApBA,CANF,EA0BYP,EAAD;AACrB,aAAO,IAAP;AACD,KA5BW,CAAZ;AA6BAf,IAAAA,YAAY,CAAC,IAAD,EAAO,CAACuB,iBAAD,CAAP,EAA4B,CAAC,MAAD,CAA5B,EAAuCR,EAAD;AAChD,UAAI,CAACA,EAAE,CAACT,IAAJ,IAAYS,EAAE,CAACT,IAAH,KAAY,iBAA5B,EAA+C;AAC7CS,QAAAA,EAAE,CAACT,IAAH,GAAU,SAAV;AACD;;AACD,aAAOS,EAAE,CAACT,IAAH,KAAY,SAAnB;AACD,KALW,CAAZ;AAMAN,IAAAA,YAAY,CAAC,IAAD,EAAO,CAACwB,gBAAD,CAAP,EAA2B,EAA3B,EAAgCT,EAAD;AAAmB,aAAO,IAAP;AAAc,KAAhE,CAAZ;AACAf,IAAAA,YAAY,CAAC,IAAD,EAAO,CAACyB,kBAAD,EACLC,gBADK,EAELC,gBAFK,EAGLC,gBAHK,EAILC,gBAJK,EAKLC,iBALK,CAAP,EAME,CAAC,KAAD,EACA,QADA,EAEA,OAFA,EAGA,QAHA,EAIA,UAJA,EAKA,UALA,EAMA,OANA,EAOA,MAPA,EAQA,QARA,EASA,SATA,CANF,EAeef,EAAD;AAAmB,aAAO,IAAP;AAAc,KAf/C,CAAZ;AAgBD;;AAEDgB,EAAAA,gBAAgB,CAAC3B,OAAD,EAAmB4B,OAAnB,EAAoCC,QAApC;QAAsDC,iFAAa;AACjF,QAAMC,OAAO,GAAG,KAAK5B,KAAL,CAAW6B,GAAX,CAAehC,OAAO,CAACO,WAAvB,CAAhB;AACA,QAAI,CAACwB,OAAL,EAAc,OAAO,KAAP;AACdH,IAAAA,OAAO,GAAGA,OAAO,CAACK,WAAR,EAAV;;AACA,QAAIL,OAAO,CAACM,KAAR,CAAc/E,YAAd,CAAJ,EAAiC;AAC/B,UAAI,CAAC2E,UAAL,EAAiB,OAAO,KAAP;AAClB,KAFD,MAEO,IAAIF,OAAO,CAACO,UAAR,CAAmB,IAAnB,CAAJ,EAA8B;AACnC,UAAIL,UAAJ,EAAgB;AACd9B,QAAAA,OAAO,CAACoC,YAAR,CAAqB,MAAMR,OAAO,CAACS,KAAR,CAAc,CAAd,CAA3B,EAA6CR,QAA7C;AACD;;AACD,aAAO,KAAP;AACD,KALM,MAKA,IAAIE,OAAO,CAAC1B,UAAR,CAAmBiC,GAAnB,CAAuBV,OAAvB,KAAmC,KAAKW,aAAL,CAAmBD,GAAnB,CAAuBV,OAAvB,CAAnC,IAAsEC,QAAQ,KAAK,oBAAvF,EAA6G;AAClH,UAAMW,IAAI,GAAGX,QAAQ,CAACK,KAAT,CAAejF,SAAf,CAAb;;AACA,UAAIuF,IAAJ,EAAU;AACR,YAAIV,UAAU,KAAKF,OAAO,KAAK,MAAZ,IAAsBA,OAAO,KAAK,YAAvC,CAAd,EAAoE;AAClE,cAAI,CAAC5B,OAAO,CAACyC,YAAR,CAAqB,QAArB,CAAL,EAAqC;AACnCzC,YAAAA,OAAO,CAACoC,YAAR,CAAqB,QAArB,EAA+BP,QAAQ,CAACa,SAAT,CAAmBF,IAAI,CAAC,CAAD,CAAJ,CAAQG,MAA3B,CAA/B;AACD;;AACD3C,UAAAA,OAAO,CAACoC,YAAR,CAAqBR,OAArB,EAA8B,oBAA9B;AACD,SALD,MAKO;AACL,iBAAO,KAAP;AACD;AACF,OATD,MASO,IAAI,CAACC,QAAQ,CAACK,KAAT,CAAehF,WAAf,CAAL,EAAkC;AACvC,eAAO,KAAP;AACD;AACF,KAdM,MAcA,IAAI,CAAC6E,OAAO,CAAC1B,UAAR,CAAmBiC,GAAnB,CAAuBV,OAAvB,CAAD,IAAoC,CAAClC,wBAAwB,CAAC4C,GAAzB,CAA6BV,OAA7B,CAAzC,EAAgF;AACrF,aAAO,KAAP;AACD,KAFM,MAEA,IAAI5B,OAAO,YAAYa,gBAAnB,IAAuCe,OAAO,IAAI,MAAtD,EAA8D;AACnE,aAAO,KAAKgB,aAAL,CAAmBN,GAAnB,CAAuBT,QAAvB,CAAP;AACD,KAFM,MAEA,IAAI7B,OAAO,YAAYY,iBAAnB,IAAwCgB,OAAO,IAAI,MAAvD,EAA+D;AACpE,aAAOC,QAAQ,KAAK,OAAb,IAAwBA,QAAQ,KAAK,QAA5C;AACD;;AACD,WAAO,IAAP;AACD;;AAEDgB,EAAAA,YAAY,CAAC7C,OAAD;QAAoC8C,iFAAa;;AAC3D,QAAI,EAAE9C,OAAO,YAAY+C,gBAArB,CAAJ,EAA4C;AAC1C,UAAMhB,OAAO,GAAG,KAAK5B,KAAL,CAAW6B,GAAX,CAAehC,OAAO,CAACO,WAAvB,CAAhB;;AACA,UAAI,CAACwB,OAAD,IAAY,CAACA,OAAO,CAAC/B,OAAR,CAAgBA,OAAhB,CAAb,IAA0C8C,UAAU,KAAK9C,OAAO,YAAYoB,gBAAnB,IAAuCpB,OAAO,YAAYmB,iBAA/D,CAAxD,EAA4I;AAC1InB,QAAAA,OAAO,CAACgD,MAAR;AACA;AACD,OAHD,MAGO;AACL,aAAK,IAAIC,GAAT,IAAgB,CAAC,GAAGjD,OAAO,CAACK,UAAZ,CAAhB,EAAyC;AACvC,cAAMwB,QAAQ,GAAGoB,GAAG,CAACC,SAArB;AACA,cAAMtB,OAAO,GAAGqB,GAAG,CAACE,QAApB;;AACA,cAAI,CAAC,KAAKxB,gBAAL,CAAsB3B,OAAtB,EAA+B4B,OAA/B,EAAwCC,QAAxC,EAAkD,CAACiB,UAAnD,CAAD,IAAoEA,UAAU,IAAI,CAAC,IAAD,EAAO,OAAP,EAAgBM,QAAhB,CAAyBxB,OAAzB,CAAtF,EAA0H;AACxH5B,YAAAA,OAAO,CAACqD,eAAR,CAAwBJ,GAAG,CAACE,QAA5B;AACD;AACF;AACF;AACF;;AACD,QAAInD,OAAO,CAACsD,QAAZ,EAAsB;AACpB,WAAK,IAAI3C,EAAT,IAAe,CAAC,GAAGX,OAAO,CAACsD,QAAZ,CAAf,EAAsC;AACpC,aAAKT,YAAL,CAAkBlC,EAAlB,EAAsBmC,UAAtB;AACD;AACF;AACF;;AAEDS,EAAAA,gBAAgB,CAACC,MAAD,EAAkBP,GAAlB,EAA+BQ,EAA/B,EAA4DX,UAA5D;QAAiFY,iFAAa;AAC5G,QAAMC,IAAI,GAAoB,IAAIhE,GAAJ,EAA9B;AAEA,QAAIiE,QAAQ,cAAOX,GAAP,oBAAoBA,GAApB,gBAA6BA,GAA7B,OAAZ;;AACA,QAAMY,QAAQ,GAAIC,IAAD;AACf,UAAIhB,UAAJ,EAAgB;AACd,aAAK,IAAInC,EAAT,IAAemD,IAAI,CAACR,QAApB,EAA8B;AAC5B,eAAKT,YAAL,CAAkBlC,EAAlB,EAAsBmC,UAAtB;AACD;AACF,OAJD,MAIO;AACL,aAAKD,YAAL,CAAkBiB,IAAlB,EAAwBhB,UAAxB;AACD;AACF,KARD;;AAUA,aAASiB,WAAT,CAAqBD,IAArB,EAAoChB,UAApC;AACE,aAAO,IAAIkB,OAAJ,CAAsBC,OAAD;AAC1BJ,QAAAA,QAAQ,CAACC,IAAD,CAAR;AACA,YAAMI,QAAQ,GAAG,IAAIC,gBAAJ,CAAsBC,IAAD;AACpC,eAAK,IAAIC,GAAT,IAAgBD,IAAhB,EAAsB;AACpB,iBAAK,IAAIE,MAAT,IAAmBD,GAAG,CAACE,UAAvB,EAAmC;AACjC,kBAAID,MAAM,YAAYE,OAAtB,EAA+B;AAC7B,qBAAK3B,YAAL,CAAkByB,MAAlB,EAA0BxB,UAA1B;AACD;AACF;AACF;AACF,SARgB,CAAjB;AASA2B,QAAAA,QAAQ,CAACC,gBAAT,CAA0B,kBAA1B,EAA8C;AAC5CC,UAAAA,GAAG;AACHV,UAAAA,OAAO,CAACH,IAAD,CAAP;AACD,SAHD;AAIAI,QAAAA,QAAQ,CAACU,OAAT,CAAiBd,IAAjB,EAAuB;AAACe,UAAAA,SAAS,EAAE,IAAZ;AAAkBC,UAAAA,OAAO,EAAE;AAA3B,SAAvB;;AACA,YAAMH,GAAG,GAAG;AACVT,UAAAA,QAAQ,CAACa,UAAT;AACApB,UAAAA,IAAI,CAACqB,MAAL,CAAYL,GAAZ;AACD,SAHD;;AAIAhB,QAAAA,IAAI,CAACsB,GAAL,CAASN,GAAT;AACD,OArBM,CAAP;AAsBD;;AAED,QAAIF,QAAQ,CAACS,UAAT,KAAwB,SAAxB,IAAqCxB,UAAzC,EAAqD;AACnD,UAAMyB,KAAK,GAAG,IAAIC,OAAJ,EAAd;;AACA,UAAMC,OAAO,GAAIvB,IAAD;AACd,YAAI,CAACA,IAAD,IAASA,IAAI,KAAKN,MAAtB,EAA8B,OAAO,KAAP;AAC9B,YAAI2B,KAAK,CAAC7C,GAAN,CAAUwB,IAAV,CAAJ,EAAqB,OAAO,IAAP;AACrB,eAAOuB,OAAO,CAACvB,IAAI,CAACwB,aAAN,CAAd;AACD,OAJD;;AAKA,UAAMpB,QAAQ,GAAG,IAAIC,gBAAJ,CAAsBC,IAAD;AACpC,aAAK,IAAIC,GAAT,IAAgBD,IAAhB,EAAsB;AACpB,eAAK,IAAIN,IAAT,IAAiBO,GAAG,CAACE,UAArB,EAAiC;AAC/B,gBAAIT,IAAI,YAAYU,OAApB,EAA6B;AAC3B,kBAAIC,QAAQ,CAACS,UAAT,KAAwB,SAA5B,EAAuC;AACrC,oBAAI,CAACG,OAAO,CAACvB,IAAD,CAAR,IAAkBA,IAAI,CAACyB,OAAL,CAAa3B,QAAb,CAAtB,EAA8C;AAC5CuB,kBAAAA,KAAK,CAACF,GAAN,CAAUnB,IAAV;AACAC,kBAAAA,WAAW,CAACD,IAAD,EAAOhB,UAAP,CAAX,CAA8B0C,IAA9B,CAAoC7E,EAAD;AACjC8C,oBAAAA,EAAE,CAAC9C,EAAD,CAAF;AACD,mBAFD;AAGD,iBALD,MAKO;AACL,uBAAK,IAAIA,EAAT,IAAemD,IAAI,CAAC2B,gBAAL,CAAsB7B,QAAtB,CAAf,EAAgD;AAC9C,wBAAI,CAACyB,OAAO,CAAC1E,EAAD,CAAZ,EAAkB;AAChBwE,sBAAAA,KAAK,CAACF,GAAN,CAAUtE,EAAV;AACAoD,sBAAAA,WAAW,CAACpD,EAAD,EAAKmC,UAAL,CAAX,CAA4B0C,IAA5B,CAAkC7E,EAAD;AAC/B8C,wBAAAA,EAAE,CAAC9C,EAAD,CAAF;AACD,uBAFD;AAGD;AACF;AACF;AACF,eAhBD,MAgBO,IAAImD,IAAI,CAACyB,OAAL,CAAa3B,QAAb,CAAJ,EAA4B;AACjCC,gBAAAA,QAAQ,CAACC,IAAD,CAAR;AACAL,gBAAAA,EAAE,CAACK,IAAD,CAAF;AACD,eAHM,MAGA;AACL,qBAAK,IAAInD,GAAT,IAAemD,IAAI,CAAC2B,gBAAL,CAAsB7B,QAAtB,CAAf,EAAgD;AAC9CC,kBAAAA,QAAQ,CAACC,IAAD,CAAR;AACAL,kBAAAA,EAAE,CAAC9C,GAAD,CAAF;AACD;AACF;AACF;AACF;AACF;AACF,OAhCgB,CAAjB;;AAiCA,UAAI,CAAC+C,UAAL,EAAiB;AACfe,QAAAA,QAAQ,CAACC,gBAAT,CAA0B,kBAA1B,EAA8C;AAC5CC,UAAAA,GAAG;AACJ,SAFD;AAGD;;AACDT,MAAAA,QAAQ,CAACU,OAAT,CAAiBpB,MAAjB,EAAyB;AAACqB,QAAAA,SAAS,EAAE,IAAZ;AAAkBC,QAAAA,OAAO,EAAE;AAA3B,OAAzB;;AACA,UAAMH,GAAG,GAAG;AACVT,QAAAA,QAAQ,CAACa,UAAT;AACApB,QAAAA,IAAI,CAACqB,MAAL,CAAYL,GAAZ;AACD,OAHD;;AAIAhB,MAAAA,IAAI,CAACsB,GAAL,CAASN,GAAT;AACD;;AAED,QAAInB,MAAM,CAAC+B,OAAP,CAAe3B,QAAf,CAAJ,EAA8B;AAC5BC,MAAAA,QAAQ,CAACL,MAAD,CAAR;AACAC,MAAAA,EAAE,CAACD,MAAD,CAAF;AACD,KAHD,MAGO;AACL,WAAK,IAAI7C,EAAT,IAAe6C,MAAM,CAACiC,gBAAP,CAAwB7B,QAAxB,CAAf,EAAkD;AAChDC,QAAAA,QAAQ,CAAClD,EAAD,CAAR;AACA8C,QAAAA,EAAE,CAAC9C,EAAD,CAAF;AACD;AACF;;AAED,WAAO;AACL+E,MAAAA,MAAM;AACJ,aAAK,IAAIf,IAAT,IAAgBhB,IAAhB,EAAsB;AACpBgB,UAAAA,IAAG;AACJ;AACF;;AALI,KAAP;AAOD;;;;;;"}